# Filmorate
***
Filmorate — это серверное Java-приложение для работы с рейтингами фильмов и социальной активностью пользователей.
## Основной функционал
Проект реализован на основе `Spring Boot` и включает основные функции:
* добавление и обновление фильмов и пользователей;
* система лайков для фильмов;
* сортировка фильмов по популярности;
* поддержка жанров и возрастных рейтингов;
* система дружбы с подтверждением (pending / confirmed);
* `REST API` для взаимодействия с клиентами.

## ER диограмма
![ER_диограмма](https://i.yapx.ru/ZUC3J.png)

### Описание диаграммы:

| Название таблицы          | Описание                                                                       |
|:--------------------------| ------------------------------------------------------------------------------ |
| **`users`**               | Информация о пользователях: id, email, логин, имя, дата рождения               |
| **`films`**               | Фильмы: id, название, описание, дата выпуска, длительность, рейтинг            |
| **`genres`**              | Жанры фильмов                                                                  |
| **`likes`**               | Связь "многие ко многим" между пользователями и фильмами (лайки)               |
| **`films_genres`**        | Связь "многие ко многим" между фильмами и жанрами                              |
| **`friendships`**           | Дружба между пользователями с полем статуса (подтверждённая, неподтверждённая) |

### Примеры запросов к БД:
Получение всех фильмов.
```sql
SELECT * FROM films;
```
Найти фильмы, у которых рейтинг равен `PG-13`.
```sql
SELECT name, rating FROM films WHERE rating = 'PG-13';
```
Вывести ТОП-10 фильмов по количеству лайков.
```sql
SELECT f.film_id, f.name, COUNT(l.user_id) AS likes_count
FROM films f
LEFT JOIN likes l ON f.film_id = l.film_id
GROUP BY f.film_id, f.name
ORDER BY likes_count DESC
LIMIT 10;
```
Получение всех пользователей.
```sql
SELECT * FROM users;
```
Вывести всех друзей пользователя с id `123`.
```sql
SELECT u.user_id, f.status
FROM users u
JOIN friendships f ON
   (
     (u.user_id = f.addressee_id AND f.requester_id = 123)
     OR
     (u.user_id = f.requester_id AND f.addressee_id = 123)
   );
```

## Stack проекта
* Java 23
* Spring-Boot
* Maven
* Lombok
